<% content_for :content_header do %>
Dashboard
<% end %>

<% content_for :content_intro do %>
  <h2 class="frame--title">Greetings, <%= current_user.first_name %></h2>
  <p>
    Welcome to VOCAT 3. From here, you can view and score submissions, manage your courses, upload video and other
    documents, interact with your classes, and access useful statistical data for all of your courses.
  </p>
<% end %>

<% content_for :content_frames do %>
  <% current_user.courses.each do |course| %>
    <div class="portfolio-frame">
      <h2 class="frame--title"><%= link_to course, course_user_evaluations_path(course)  %></h2>
      <div class="clearfix space-bottom">

        <figure class="summary-box">
          <div>
            <b style="height: <%= course.submission_video_percentage() %>%"></b>
            <span><%= course.submission_video_percentage() %></span><small>%</small>
          </div>
          <figcaption>Submissions with Videos</figcaption>
        </figure>

        <figure class="summary-box">
          <div>
            <b style="height: <%= course.average_evaluator_score() %>%"></b>
            <span><%= course.average_evaluator_score() %></span><small>%</small>
          </div>
          <figcaption>Average Instructor Score</figcaption>
        </figure>

        <% if course.settings['enable_peer_review'] %>
        <figure class="summary-box">
          <div>
            <b style="height: <%= course.average_peer_score() %>%"></b>
            <span><%= course.average_peer_score() %></span><small>%</small>
          </div>
          <figcaption>Average Peer Score</figcaption>
        </figure>
        <% end %>

        <figure class="summary-box">
          <div>
            <span><%= course.creators.count %></span><small></small>
          </div>
          <figcaption>Students</figcaption>
        </figure>

        <figure class="summary-box">
          <div>
            <span><%= course.annotation_count() %></span>
          </div>
          <figcaption>Annotations</figcaption>
        </figure>

        <figure class="summary-box">
          <div>
            <span><%= course.discussion_post_count() %></span><small></small>
          </div>
          <figcaption>Comments</figcaption>
        </figure>

      </div>

      <div class="clearfix">
        <div style="width: 46.8rem; padding-right: 1.6rem; float: left">
          <h3 class="heading-large">
            Recently Updated Submissions
          </h3>

          <ul style="margin-top: 0px" class="unstyled-list">
            <% course.recent_submissions(course.projects.count).each do |submission| %>
              <li>
                <% if submission.creator_type == 'Group' %>
                  <%= link_to "#{submission.creator_name} - #{submission.project_name}", course_group_evaluations_path(course_id: course, creator_id: submission.creator, project_id: submission.project) %>
                <% else %>
                  <%= link_to "#{submission.creator_name} - #{submission.project_name}", course_user_evaluations_path(course_id: course, creator_id: submission.creator, project_id: submission.project) %>
                <% end %>
              </li>
            <% end %>
          </ul>
        </div>

        <div style="width: 46.8rem; float: left">

          <h3 class="heading-large">
            Course Projects
          </h3>

          <ul style="margin-top: 0px" class="unstyled-list">
            <% course.projects.each do |project| %>
              <li><%= link_to project, course_user_evaluations_path(course_id: course, project_id: project) %></li>
            <% end %>
          </ul>

        </div>

      </div>

    </div>
  <% end %>
<% end %>
